<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeria Interativa | 9¬∫ Ano</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
/* -------------------------- */
/* VARI√ÅVEIS DE DESIGN (Clean & LIGHT GREEN) */
/* -------------------------- */
:root {
    --fonte-principal: 'Poppins', sans-serif;
    
    /* Fundo SUAVE E VERDE/CIANO */
    --bg-gradiente: linear-gradient(120deg, #d4f7e8 0%, #a2e8e8 100%); 
    
    /* Cores dos Elementos */
    --cor-card: #ffffff;
    --cor-texto: #4a4a4a;
    --cor-titulo: #2c3e50;
    
    /* Cores do Bot√£o */
    --btn-inicial: #00796B; 
    --btn-transicao-1: #96c93d; 
    --btn-transicao-2: #00b09b; 
    --btn-final: #ff4d4d; /* Vermelho para o √∫ltimo est√°gio */ 

    /* Sombras */
    --sombra-card: 0 10px 20px rgba(0,0,0,0.05);
    --sombra-hover: 0 15px 30px rgba(0,0,0,0.15);
}

body {
    font-family: var(--fonte-principal);
    background-image: var(--bg-gradiente); 
    background-attachment: fixed;
    background-size: cover;
    color: var(--cor-texto);
    margin: 0;
    padding: 0;
    min-height: 100vh;
    overflow-x: hidden;
}

/* TELA DE INTRODU√á√ÉO */
#introScreen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); z-index: 2000;
    display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px;
}
.intro-card {
    background: white; padding: 40px; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    text-align: center; max-width: 400px; width: 100%; animation: fadeInDown 0.8s ease;
}
.intro-card h2 { margin-top: 0; color: var(--cor-titulo); }
.intro-input {
    width: 100%; padding: 15px; margin: 20px 0; border: 2px solid #eee; border-radius: 10px;
    font-family: var(--fonte-principal); font-size: 1rem; outline: none; transition: border-color 0.3s; box-sizing: border-box;
}
.intro-input:focus { border-color: var(--btn-inicial); }
.btn-entrar {
    background: var(--btn-inicial); color: white; border: none; padding: 12px 30px;
    font-size: 1rem; border-radius: 50px; cursor: pointer; transition: all 0.2s; font-weight: 600;
}
.btn-entrar:hover {
    transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 121, 107, 0.4); 
}

/* CONTE√öDO PRINCIPAL (GALERIA GERAL) */
#mainContent { display: none; opacity: 0; transition: opacity 1s ease; }
header { text-align: center; padding: 40px 20px; }
h1 {
    font-weight: 800; color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.1);
    font-size: 2.5rem; margin: 0;
}
.galeria {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px; max-width: 1200px; margin: 0 auto; padding: 20px; list-style: none;
}
.item-galeria {
    background: var(--cor-card); border-radius: 15px; overflow: hidden;
    box-shadow: var(--sombra-card); transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer;
}
.item-galeria:hover { transform: translateY(-10px); box-shadow: var(--sombra-hover); }
.item-galeria img {
    width: 100%; height: 250px; object-fit: cover; display: block;
}
.item-galeria figcaption {
    padding: 20px; font-weight: 600; color: var(--cor-texto); text-align: center;
}

/* Bot√µes Padr√£o */
.container-botao { display: flex; justify-content: center; margin: 60px 0 100px 0; }
.btn-padrao {
    padding: 18px 40px; font-size: 1.1rem; font-weight: 600; font-family: var(--fonte-principal);
    color: white; border: none; border-radius: 50px; cursor: pointer; outline: none;
    background-color: var(--btn-inicial); box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
.btn-padrao:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0, 121, 107, 0.4); }
.btn-padrao:disabled { opacity: 0.6; cursor: not-allowed; }

/* Est√°gios de Clique Final */
#btnAtivarFinal.stage-1 { background-color: var(--btn-transicao-1); }
#btnAtivarFinal.stage-2 { background-color: var(--btn-transicao-2); }
#btnAtivarFinal.stage-final { background-color: var(--btn-final); box-shadow: 0 0 30px rgba(255, 77, 77, 0.6); } 

/* Anima√ß√µes */
.animacao-clique { transform: scale(0.9); }
@keyframes pulseBoom {
    0% { transform: scale(1); } 50% { transform: scale(1.2); box-shadow: 0 0 50px rgba(52, 168, 83, 0.8); }
    100% { transform: scale(1); }
}
.animacao-boom { animation: pulseBoom 0.6s ease-out; }
@keyframes fadeInDown {
    0% { opacity: 0; transform: translateY(-20px); } 100% { opacity: 1; transform: translateY(0); }
}
@keyframes slideUp {
    0% { opacity: 0; transform: translateY(50px); } 100% { opacity: 1; transform: translateY(0); }
}

/* -------------------------- */
/* TELA INTERMEDI√ÅRIA (BOLINHAS) */
/* -------------------------- */
#telaIntermediaria {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-image: var(--bg-gradiente); 
    z-index: 2500; display: none; flex-direction: column; justify-content: center; align-items: center;
    color: var(--cor-texto); 
    opacity: 0; transition: opacity 1s ease; padding: 20px;
}

.intermediaria-content {
    max-width: 900px; width: 100%;
    background: var(--cor-card); 
    padding: 30px; border-radius: 15px;
    box-shadow: var(--sombra-hover); 
    animation: fadeInDown 0.8s ease;
}

#tituloIntermediario {
    font-size: 2rem; color: var(--cor-titulo); margin-bottom: 20px; 
}

#galeriaBolinhas {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); 
    gap: 15px 5px; 
    padding: 20px 0;
    justify-content: center;
}

.bolinha-container {
    display: flex; flex-direction: column; align-items: center; text-align: center;
    width: 100%; padding: 10px 0; position: relative;
    transition: transform 0.3s ease;
}

.bolinha {
    width: 100px; height: 100px; border-radius: 50%;
    background-color: #e0f7fa; border: 3px solid #b2ebf2; 
    display: flex; justify-content: center; align-items: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    overflow: hidden; flex-shrink: 0; 
}

.bolinha img {
    width: 100%; height: 100%; object-fit: cover; border-radius: 50%;
}

.bolinha-legenda {
    margin-top: 3px; font-size: 0.85rem; font-weight: 400; color: var(--cor-texto);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100px; 
}

/* --- INTERATIVIDADE MANEIRA (SPOTLIGHT & BUBBLES) --- */

/* 1. Efeito Spotlight (Holofote) */
/* Quando passar o mouse na galeria, apaga todos */
#galeriaBolinhas:hover .bolinha-container {
    opacity: 0.4;
    filter: blur(2px) grayscale(60%);
    transform: scale(0.95);
    transition: all 0.4s ease;
}
/* Quando passar o mouse em UM espec√≠fico, acende ele */
#galeriaBolinhas .bolinha-container:hover {
    opacity: 1;
    filter: blur(0) grayscale(0%);
    transform: scale(1.15) translateY(-10px);
    z-index: 10;
    cursor: pointer;
}

/* 2. Bal√£o de Frase (Speech Bubble) */
.frase-bubble {
    position: absolute;
    bottom: 85%; /* Acima da bolinha */
    left: 50%;
    transform: translateX(-50%) scale(0);
    background: white;
    padding: 10px 15px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    font-size: 0.8rem;
    color: #333;
    font-weight: 600;
    width: 140px;
    pointer-events: none;
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    z-index: 20;
    border: 2px solid var(--btn-inicial);
}
.frase-bubble::after {
    content: ''; position: absolute; top: 100%; left: 50%; margin-left: -8px;
    border-width: 8px; border-style: solid;
    border-color: var(--btn-inicial) transparent transparent transparent;
}
/* Classe ativada via JS */
.bolinha-container.ativa .frase-bubble {
    transform: translateX(-50%) scale(1);
    opacity: 1;
    bottom: 110%; /* Sobe um pouquinho */
}

/* 3. Anima√ß√£o de Part√≠culas (Emojis) */
.particle {
    position: absolute; pointer-events: none;
    animation: floatUp 1s ease-out forwards;
    font-size: 1.2rem; z-index: 15;
}
@keyframes floatUp {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    100% { transform: translateY(-60px) scale(1.5) rotate(20deg); opacity: 0; }
}


.intermediaria-footer {
    display: flex; justify-content: space-between; align-items: center;
    margin-top: 20px; flex-wrap: wrap; 
}
.nav-buttons button {
    background-color: var(--btn-inicial); padding: 10px 20px; margin: 0 5px;
    border: none; border-radius: 10px; color: white; font-weight: 600;
    cursor: pointer; transition: background-color 0.2s;
}
.nav-buttons button:disabled { background-color: #b0b0b0; cursor: not-allowed; }
.nav-buttons button:hover:not(:disabled) { background-color: #004d40; }
#btnAtivarFinal { order: 3; }
        
/* -------------------------- */
/* TELA FINAL (Good Ending) */
/* -------------------------- */
#paginaFinal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    /* Imagem de fundo opcional ou cor solida */
    background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://upload.wikimedia.org/wikipedia/commons/b/b6/%28vila_missionaria%29_do_morro_olhando_em_dire%C3%A7%C3%A3o_para_posto_Hudson_-_panoramio.jpg');
    background-size: cover; background-position: center; z-index: 3000; display: none; 
    flex-direction: column; justify-content: center; align-items: center; text-align: center;
    color: white; opacity: 0; transition: opacity 1s ease;
}
.final-content {
    background: rgba(0, 0, 0, 0.4); padding: 40px; border-radius: 20px; 
    backdrop-filter: blur(8px); max-width: 80%; margin-bottom: 30px; animation: slideUp 1s ease;
    border: 1px solid rgba(255, 255, 255, 0.3); box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5); 
}
#paginaFinal h2 {
    color: white; font-size: 3.5rem; margin-bottom: 20px; 
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.8), 2px 2px 10px rgba(0,0,0,0.5);
    line-height: 1.1; margin-top: 0;
}
#paginaFinal p { 
    color: white; font-size: 1.5rem; font-weight: 300; 
    text-shadow: 0 0 3px rgba(255, 255, 255, 0.7);
}
.highlight-name { 
    color: #ffd700; font-weight: 800; text-transform: uppercase; 
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.9);
}
.music-container { margin-top: 20px; opacity: 0.8; transition: opacity 0.3s; }
.music-label { font-size: 0.9rem; margin-bottom: 5px; color: #ddd; }
#audioPlayer {
    border-radius: 10px; background: rgba(255, 255, 255, 0.2); padding: 5px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3); width: 350px; max-width: 90vw;
}

/* MODAL VISUALIZADOR */
#imageModal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.9); z-index: 4000; display: none;
    justify-content: center; align-items: center; cursor: pointer;
}
.modal-content-container {
    width: 90%; height: 90%; display: flex; justify-content: center;
    align-items: center; position: relative;
}
#modalImage {
    max-width: 100%; max-height: 100%; object-fit: contain; cursor: zoom-in;
    transform: scale(1); transform-origin: 50% 50%; transition: transform 0.1s ease;
}
#btnCloseModal {
    position: absolute; top: 20px; right: 20px; color: white; font-size: 40px;
    font-weight: bold; cursor: pointer; text-shadow: 0 0 10px rgba(0,0,0,0.8);
    line-height: 1; transition: color 0.2s;
}
#btnCloseModal:hover { color: var(--btn-final); }

@media (max-width: 768px) {
    .intermediaria-footer { flex-direction: column; }
    .nav-buttons { margin-bottom: 15px; }
    #btnAtivarFinal { margin-top: 15px; order: 1; }
    .bolinha { width: 80px; height: 80px; }
    .bolinha-container { width: auto; }
    #galeriaBolinhas { grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); }
    .bolinha-legenda { max-width: 80px; }
}
    </style>
</head>
<body>

    <div id="introScreen">
        <div class="intro-card">
            <h2>Bem-vindo(a)!</h2>
            <p>Antes de come√ßarmos, como devemos te chamar?</p>
            <input type="text" id="nomeInput" class="intro-input" placeholder="Digite seu nome aqui..." autocomplete="off">
            <button class="btn-entrar" onclick="iniciarSite()">Entrar na Galeria</button>
        </div>
    </div>

    <div id="mainContent">
        <header>
            <h1>Galeria do 9¬∫ Ano</h1>
            <p style="color: white; opacity: 0.9;">Explore e descubra lembran√ßas.</p>
        </header>

        <main>
            <ul class="galeria">
                <li class="item-galeria" onclick="openModal(this)">
                    <img src="interclasse.jpg" alt="Interclasse">
                    <figcaption>Inspira√ß√£o</figcaption>
                </li>
                <li class="item-galeria" onclick="openModal(this)">
                    <img src="meninaS.jpg" alt="Meninas">
                    <figcaption>Criatividade</figcaption>
                </li>
                <li class="item-galeria" onclick="openModal(this)">
                    <img src="galeria.jpg" alt="Galeria">
                    <figcaption>Uni√£o</figcaption>
                </li>
                <li class="item-galeria" onclick="openModal(this)">
                    <img src="matheustirando.jpg" alt="Matheus">
                    <figcaption>Cuidado</figcaption>
                </li>
                <li class="item-galeria" onclick="openModal(this)">
                    <img src="alesandra.jpg" alt="Alessandra">
                    <figcaption>Carinho</figcaption>
                </li>
                <li class="item-galeria" onclick="openModal(this)">
                    <img src="crias.jpg" alt="Os Crias">
                    <figcaption>Estilo de Vida</figcaption>
                </li>
            </ul>

            <div class="container-botao">
                <button id="btnProximaPagina" class="btn-padrao" onclick="passarParaIntermediaria()">
                    Continuar
                </button>
            </div>
        </main>
    </div>

    <div id="telaIntermediaria">
        <div class="intermediaria-content">
            <h2 id="tituloIntermediario">Alunos do 9¬∫ (P√°gina 1/3)</h2>
            
            <div id="galeriaBolinhas">
                </div>

            <div class="intermediaria-footer">
                <p style="color: var(--cor-texto); font-size: 0.9rem;">Clique nos alunos para ver o status!</p>
                
                <div class="nav-buttons">
                    <button id="btnAnterior" onclick="mudarPagina(-1)" disabled>‚Üê Anterior</button>
                    <button id="btnProximo" onclick="mudarPagina(1)">Pr√≥ximo ‚Üí</button>
                </div>
                
                <button id="btnAtivarFinal" class="btn-padrao">
                    Pr√≥xima Etapa
                </button>
            </div>
        </div>
    </div>

    <div id="imageModal">
        <span id="btnCloseModal" onclick="closeModal()">&times;</span>
        <div class="modal-content-container">
            <img id="modalImage" src="" alt="Imagem Ampliada">
        </div>
    </div>

    <div id="paginaFinal">
        <div class="final-content">
            <h2>GOOD ENDING</h2>
            <p>Parab√©ns, <span id="nomeFinal" class="highlight-name">Visitante</span>!</p>
            <p>Voc√™ encontrou o final feliz.<br>Lembre-se: N√£o chore porque acabou, sorria porque aconteceu.</p> 
        </div>

        <div class="music-container">
            <div class="music-label">‚ô´ Amar Como Voc√™ - (Arquivo Local)</div>
            
            <audio id="audioPlayer" loop controls>
                <source src="good-ending.mp3" type="audio/mpeg">
                Seu navegador n√£o suporta o elemento de √°udio.
            </audio>
        </div>
    </div>

    <script>
        let nomeUsuario = "";
        const limiteCliquesFinal = 5;
        let contadorCliquesFinal = 0; 

        // --- DADOS DOS ALUNOS (28 nomes listados) ---
        const nomesBolinhas = [
            "Jo√£o Vitor", "Luan", "Beatriz", "Kaio", "Alicia", "Bernardo", 
            "Evelyn", "Gabriel Dantas", "Gabriel Barbosa", "Georgia", "Gyzelly", 
            "Adriano", "Laura Viegas", "Luana", "Matheus", "Melissa", "Rhuan", 
            "Ryan", "Sarah Lima", "Theo", "Ana Clara", "Maria Eduarda Fernandes", 
            "Gabriela", "Maria Pereira", "Maria de Jesus", "Sarah Oliveira", "Laurinha",
            "Manuella" 
        ];

        // --- IMAGENS (Certifique-se que as imagens existem na pasta) ---
        const urlsImagens = [
            "eu.jpg", "lua.jpg", "beatriz.jpg", "kaio.jpg", "ali.jpg", "bern.jpg", 
            "eve.png", "dantas.png", "grabrielb.png", "geo.jpg", "gy.jpg", 
            "adri.jpg", "viegas.png", "lu.jpg", "mat.jpg", "melissa.jpg", "rh.jpg", 
            "Ry.jpg", "sarah.jpg", "theo.jpg", "ana.png", "fernandes.png", 
            "gabi.png", "pereira.png", "mariadejesus.jpg", "Sa.jpg", "laur.jpg",
            "manu.jpg" 
        ];

        // --- 40 FRASES √öNICAS (Mais op√ß√µes para a turma) ---
        const frasesUnicas = [
            "O inimigo do fim ‚úåÔ∏è", "S√≥ sei que nada sei...", "Futuro presidente üëî",
            "Presente, fessora! üôã", "Vai deixar saudades üò¢", "Mestre da soneca üò¥",
            "Rei/Rainha do TikTok üì±", "Sempre com fome üçî", "Zero paci√™ncia para a aula das 7h ü•±",
            "A lenda viva ‚ú®", "Rindo de nervoso üòÖ", "Cad√™ meu carregador? üîå",
            "N√£o estudei, mas gabaritei ü§ì", "Vou sentir falta da merenda üçé", "O rei do fund√£o üëë",
            "Atrasado (como sempre) üèÉ", "Eu ouvi fofoca? ü´¢", "S√≥ vim pela chamada üìù",
            "Mestre na arte de enrolar o trabalho üòé", "Calma, √© para hoje? üìÖ", "O mestre do ctrl+c, ctrl+v üòá",
            "O terror da coordena√ß√£o üòà", "Especialista em m√≠mica üé≠", "Rainha/rei do drama, mas com amor ‚ù§Ô∏è",
            "S√≥ tiro 10 (em dormir) üíØ", "Aposentado(a) aos 15 üë¥", "F√£ n√∫mero 1 do recreio ü•™",
            "Rindo pra n√£o chorar üòÇ", "At√© que enfim acabou! üéì", "Pr√≥xima parada: o ensino m√©dio (se Deus quiser) üôè",
            "Chegou a hora de sumir por tr√™s meses üò∂‚Äçüå´Ô∏è", "O que chorou no √∫ltimo dia. üò≠", "Zero paci√™ncia para a aula das 7h. ü•±",
            "Lan√ßando a moda no corredor üëö", "Meu objetivo: passar sem recupera√ß√£o ‚úÖ", "O que virou meme oficial da turma ü§£",
            "Empreendedor(a) nato(a) (vendia doce) üç¨", "Zero paci√™ncia para o recreio de 20 minutos ‚è±Ô∏è",
            "O que n√£o entendia nada de Matem√°tica üìâ", "O que sentava perto da janela üñºÔ∏è",
            "Formando 2024! ü•≥", "Onde est√° a festa? üéâ", "O pr√≥ximo Neymar/Marta ‚öΩÔ∏è" 
        ];

        // VARI√ÅVEIS DE CONTROLE
        const totalBolinhas = nomesBolinhas.length; 
        const bolinhasPorPagina = 12; 
        const totalPaginas = Math.ceil(totalBolinhas / bolinhasPorPagina); 
        let paginaAtual = 1;
        let frasesAtribuidas = []; 

        // Elementos do DOM
        const introScreen = document.getElementById('introScreen');
        const mainContent = document.getElementById('mainContent');
        const nomeInput = document.getElementById('nomeInput');
        const nomeFinalDisplay = document.getElementById('nomeFinal');
        const botaoGaleria = document.getElementById('btnProximaPagina');
        const botaoFinal = document.getElementById('btnAtivarFinal'); 
        const paginaFinal = document.getElementById('paginaFinal');
        const audioPlayer = document.getElementById('audioPlayer'); 
        const telaIntermediaria = document.getElementById('telaIntermediaria');
        const galeriaBolinhas = document.getElementById('galeriaBolinhas');
        const tituloIntermediario = document.getElementById('tituloIntermediario');
        const btnAnterior = document.getElementById('btnAnterior');
        const btnProximo = document.getElementById('btnProximo');

        // Modal
        const imageModal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        let currentScale = 1;

        // Fun√ß√£o auxiliar para embaralhar um array (Algoritmo Fisher-Yates)
        function embaralharArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- FUN√á√ïES DO MODAL ---
        function openModal(itemGaleria) {
            const imgSrc = itemGaleria.querySelector('img').src;
            modalImage.src = imgSrc;
            imageModal.style.display = 'flex';
            currentScale = 1;
            modalImage.style.transform = `scale(${currentScale})`;
            modalImage.style.cursor = 'zoom-in';
            modalImage.style.objectFit = 'contain';
        }

        function closeModal() {
            imageModal.style.display = 'none';
            modalImage.style.transform = 'scale(1)';
            currentScale = 1;
            modalImage.style.cursor = 'zoom-in';
            modalImage.style.objectFit = 'contain';
        }

        modalImage.addEventListener('click', (event) => {
            event.stopPropagation();
            if (currentScale === 1) {
                currentScale = 2;
                modalImage.style.objectFit = 'none'; 
                modalImage.style.cursor = 'grab';
                const rect = modalImage.getBoundingClientRect();
                const x = (event.clientX - rect.left) / rect.width;
                const y = (event.clientY - rect.top) / rect.height;
                modalImage.style.transformOrigin = `${x * 100}% ${y * 100}%`;
                modalImage.style.transform = `scale(${currentScale})`;
            } else {
                currentScale = 1;
                modalImage.style.transform = `scale(${currentScale})`;
                modalImage.style.cursor = 'zoom-in';
                modalImage.style.objectFit = 'contain';
                modalImage.style.transformOrigin = '50% 50%';
            }
        });
        imageModal.addEventListener('click', (e) => { if (e.target === imageModal) closeModal(); });

        // --- L√ìGICA DA GALERIA DE BOLINHAS (COM FRASES √öNICAS ALEAT√ìRIAS) ---
        function gerarBolinhas() {
            // Embaralha as frases e seleciona o n√∫mero necess√°rio
            let frasesEmbaralhadas = embaralharArray([...frasesUnicas]); 
            frasesAtribuidas = frasesEmbaralhadas.slice(0, totalBolinhas);
            
            let htmlBolinhas = '';
            for (let i = 0; i < totalBolinhas; i++) {
                const imagemSrc = urlsImagens[i] || 'https://via.placeholder.com/100';
                const nomePessoa = nomesBolinhas[i];
                
                // Pega a frase ATRIBU√çDA ALEATORIAMENTE E √öNICA para esta bolinha nesta sess√£o
                const fraseUnica = frasesAtribuidas[i] || "Formando 2024! üéì"; 

                htmlBolinhas += `
                    <div class="bolinha-container bolinha-item" onclick="interagirAluno(this)">
                        <div class="frase-bubble">${fraseUnica}</div>
                        <div class="bolinha">
                            <img src="${imagemSrc}" alt="${nomePessoa}">
                        </div>
                        <span class="bolinha-legenda">${nomePessoa}</span>
                    </div>
                `;
            }
            galeriaBolinhas.innerHTML = htmlBolinhas;
        }

        function interagirAluno(elemento) {
            // Remove 'ativa' de outras bolinhas para fechar outros bal√µes
            document.querySelectorAll('.bolinha-container').forEach(el => {
                if(el !== elemento) el.classList.remove('ativa');
            });
            // Alterna a classe 'ativa' na bolinha clicada (mostra/esconde o bal√£o)
            elemento.classList.toggle('ativa');
            // Cria a explos√£o de emojis
            criarExplosaoEmojis(elemento);
        }

        function criarExplosaoEmojis(container) {
            const emojis = ['üéì', '‚ú®', 'üéâ', 'üìö', 'üòé', '‚úåÔ∏è', 'üî•'];
            for (let i = 0; i < 6; i++) {
                const span = document.createElement('span');
                span.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                span.className = 'particle';
                const randomX = (Math.random() - 0.5) * 60;
                const randomY = (Math.random() - 0.5) * 60;
                span.style.left = `calc(50% + ${randomX}px)`;
                span.style.top = `calc(50% + ${randomY}px)`;
                container.appendChild(span);
                setTimeout(() => span.remove(), 1000);
            }
        }
        
        function mostrarPagina(pagina) {
            paginaAtual = pagina;
            const inicio = (pagina - 1) * bolinhasPorPagina;
            const fim = pagina * bolinhasPorPagina;
            const bolinhaContainers = document.querySelectorAll('.bolinha-item');

            bolinhaContainers.forEach((container, index) => {
                container.style.display = (index >= inicio && index < fim) ? 'flex' : 'none';
            });
            tituloIntermediario.textContent = `Alunos do 9¬∫ (P√°gina ${paginaAtual}/${totalPaginas})`;
            btnAnterior.disabled = paginaAtual === 1;
            btnProximo.disabled = paginaAtual === totalPaginas;
        }

        function mudarPagina(direcao) {
            let novaPagina = paginaAtual + direcao;
            if (novaPagina >= 1 && novaPagina <= totalPaginas) mostrarPagina(novaPagina);
        }
        
        // --- FLUXO DO SITE ---
        function iniciarSite() {
            const nome = nomeInput.value.trim();
            if (nome === "") { alert("Por favor, digite um nome!"); return; }
            nomeUsuario = nome;
            nomeFinalDisplay.textContent = nomeUsuario;
            
            introScreen.style.opacity = '0';
            setTimeout(() => {
                introScreen.style.display = 'none';
                mainContent.style.display = 'block';
                setTimeout(() => mainContent.style.opacity = '1', 50);
            }, 500);
        }
        
        function passarParaIntermediaria() {
            botaoGaleria.disabled = true;
            mainContent.style.opacity = '0';
            setTimeout(() => {
                mainContent.style.display = 'none';
                telaIntermediaria.style.display = 'flex';
                setTimeout(() => telaIntermediaria.style.opacity = '1', 50);
            }, 500);
        }

        function ativarGoodEnding() {
            telaIntermediaria.style.opacity = '0';
            setTimeout(() => {
                telaIntermediaria.style.display = 'none';
            }, 500);
            audioPlayer.play().catch(e => console.log("Play bloqueado pelo browser"));
            paginaFinal.style.display = 'flex';
            setTimeout(() => paginaFinal.style.opacity = '1', 50);
        }

        function lidarComCliqueFinal() {
            if (contadorCliquesFinal >= limiteCliquesFinal) return;
            botaoFinal.classList.add('animacao-clique');
            setTimeout(() => botaoFinal.classList.remove('animacao-clique'), 150);
            contadorCliquesFinal++;
            botaoFinal.classList.remove('stage-1', 'stage-2', 'stage-final', 'animacao-boom');
            
            if(contadorCliquesFinal === 1) {
                botaoFinal.classList.add('stage-1');
                botaoFinal.textContent = `Pr√≥xima Etapa (1/${limiteCliquesFinal})`;
            } else if (contadorCliquesFinal === 2) {
                botaoFinal.classList.add('stage-2');
                botaoFinal.textContent = `Pr√≥xima Etapa (2/${limiteCliquesFinal})`;
            } else if (contadorCliquesFinal === 3) {
                botaoFinal.classList.add('stage-final', 'animacao-boom');
                botaoFinal.textContent = `SURPRESA! (3/${limiteCliquesFinal})`;
                setTimeout(() => botaoFinal.classList.remove('animacao-boom'), 600);
            } else if (contadorCliquesFinal === 4) {
                botaoFinal.classList.add('stage-final');
                botaoFinal.textContent = `QUASE L√Å! (4/${limiteCliquesFinal})`;
            } else {
                botaoFinal.disabled = true;
                botaoFinal.textContent = "Carregando Final...";
                ativarGoodEnding();
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            gerarBolinhas();
            mostrarPagina(1);
            botaoFinal.addEventListener('click', lidarComCliqueFinal);
            nomeInput.addEventListener("keypress", (e) => { if(e.key==="Enter") iniciarSite(); });
        });
    </script>
</body>
</html>



